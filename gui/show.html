<!DOCTYPE html>
<html>
<head>
	<title>Accounting Service</title>
	<link rel="stylesheet" type="text/css" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
	<style>
		nav ul {
			list-style-type: none;
			margin: 0;
			padding: 0;
			overflow: hidden;
			background-color: #333;
		}

		nav li {
			float: left;
		}

		nav li a {
			display: block;
			color: white;
			text-align: center;
			padding: 14px 16px;
			text-decoration: none;
		}

		nav li a:hover {
			background-color: white;
		}
		nav {
			box-shadow: 0px 1px 10px #999;
		}
		.box {
			border: 5px solid white;
			padding: 15px;
		}
		#menu ul {
			list-style-type: none;
			margin: 0;
			padding: 0;
			width: 200px;
			background-color: #f1f1f1;
		}

		#menu li a {
			display: block;
			color: #000;
			padding: 8px 16px;
			text-decoration: none;
		}

		/* Change the link color on hover */
		#menu li a:hover {
			background-color: #555;
			color: white;
		}
	</style>
</head>
<body style="font-family: montserrat; font-size: 15px; width: 100%; height: 100%;background-image: url(bg.jpg); background-repeat: no-repeat; background-attachment: fixed; background-position: center; background-size: cover;background-size: auto;">
	<nav style="background-color: #f4f6f7; width: 100%; opacity: 0.95;">
		<div class="row" style="width: 100%;">
			<div class="col-sm-8" style="width: 50%;text-align: left;padding: 15px;">
				<h1 style="padding-left: 20px; opacity: 1;">Accounting Service</h1>
			</div>
			<div class="col-sm-4" style="width: 100%; height: 100%;text-align: right;padding: 15px 0px 0px 0px;">
				<ul style=" text-align: right;opacity: 1;">
					<li><a href="home.html">Home</a></li>
					<li><a href="https://github.com/yoshimaputri/AccountingService">Github</a></li>
					<li><a href="https://app.swaggerhub.com/apis-docs/yoshimaputri/swagger-accounting/1.0.0">Documentation</a></li>
					<li><a href="https://github.com/yoshimaputri/AccountingService/blob/master/README.md">About</a></li>
				</ul>
			</div>
		</div>
	</nav>
	<div style="width: 100%; background-color: #f4f6f7; padding: 10px;">
		<div class="row" style="text-align: center; width: 100%; margin:50px;">
			<div class="col-sm-5" style="margin: 10px;">
				<h3 style="text-align: left;">Method:</h3>
				<div class="form-group">
					<select class="form-control" name="method">
						<option value="GET">GET</option>
						<!-- <option value="POST">POST</option> -->
						<!-- <option value="PATCH">PATCH</option>
						<option value="PUT">PUT</option> -->
					</select>
				</div>
			</div>
			<div class="col-sm-5" style="margin: 10px;">
				<h3 style="text-align: left;">Data:</h3>
				<div class="form-group">
					<select class="form-control" name="jenisdata">
						<option value="pendapatan">Pendapatan</option>
						<option value="pengeluaran">Pengeluaran</option>
					</select>
				</div>
			</div>
		</div>
		<div class="row" style="text-align: center; width: 100%; margin:50px;">
			<div class="col-sm-5" style="margin: 10px;">
				<h3 style="text-align: left;">Berdasarkan:</h3>
				<div class="form-group">
					<select class="form-control" name="based" onchange="showHide();">
						<option value="nothing">Tidak Ada</option>
						<option value="idres">ID Restauran</option>
						<option value="thn">Tahun</option>
					</select>
				</div>
			</div>
		</div>
		<div id="for_idres" class="row" style="text-align: center; width: 100%; margin:50px;display: none;">
			<div class="col-sm-5" style="margin: 10px; width: 100%;">
				<h3 style="text-align: left;">ID Restauran:</h3>
				<input class="form-control" type="text" name="id_restaurant">
			</div>
			<div class="col-sm-5" style="margin: 10px; width: 100%;">
				<h3 style="text-align: left;">Limit Data:</h3>
				<input class="form-control" type="text" name="limit">
			</div>
		</div>
		<div id="for_thn" class="row" style="text-align: center; width: 100%; margin:50px; display: none;">
			<div class="col-sm-4" style="margin: 10px; ">
				<h3 style="text-align: left;">Tahun:</h3>
				<input class="form-control" type="text" name="tahun">
			</div>
			<div class="col-sm-4" style="margin: 10px; ">
				<h3 style="text-align: left;">Bulan (optional):</h3>
				<input class="form-control" type="text" name="bulan">
			</div>
		</div>
		<button style="width: 25%; margin-left: 35%; text-align: center;" onclick="reqAPI()" class="btn btn-primary">Request Data</button>
	</div>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	<script src="apiCall.js"></script>
	<script type="text/javascript">
		function showHide(){
			console.log(document.querySelector('[name="based"]').value)
			if (document.querySelector('[name="based"]').value == 'idres'){
				document.getElementById('for_idres').style.display = "block";
				document.getElementById('for_thn').style.display = "none";
			}
			else if (document.querySelector('[name="based"]').value == 'thn'){
				document.getElementById('for_thn').style.display = "block";
				document.getElementById('for_idres').style.display = "none";
			}
		}
		function reqAPI(){
			const proxyUrl = 'https://cors-anywhere.herokuapp.com/';
			const BASE_URI = 'https://ojoakua.site/accounting/';
			// let id_ = document.querySelector('[name="id"]').value;
			let idRestaurant = document.querySelector('[name="id_restaurant"]').value;
			let limit = document.querySelector('[name="limit"]').value; 
			let tahun = document.querySelector('[name="tahun"]').value;
			let bulan = document.querySelector('[name="bulan"]').value; 

			let dataType = document.querySelector('[name=jenisdata]').value;
			let method = document.querySelector('[name=method]').value;

			if (document.querySelector('[name="based"]').value == 'idres'){
				document.getElementById('for_idres').style.display = "block";
				document.getElementById('for_thn').style.display = "none";
				fetch(proxyUrl + BASE_URI + dataType + '?idrest=' + idRestaurant + '&limit=' + limit)
				.then(response => response.text())
				.then(contents => console.log(contents))
				.catch(() => console.log("can't access " + BASE_URI + " response. Blocked by browser?"))
			}
			else if (document.querySelector('[name="based"]').value == 'thn'){
				document.getElementById('for_thn').style.display = "block";
				document.getElementById('for_idres').style.display = "none";
				fetch(proxyUrl + BASE_URI + dataType + '/' + tahun + '/' + bulan)
				.then(response => response.text())
				.then(contents => console.log(contents))
				.catch(() => console.log("can't access " + BASE_URI + " response. Blocked by browser?"))
			}
			else if (document.querySelector('[name="based"]').value == 'nothing'){
				fetch(proxyUrl + BASE_URI + dataType)
				.then(response => response.text())
				.then(contents => console.log(contents))
				.catch(() => console.log("can't access " + BASE_URI + " response. Blocked by browser?"))
			}
			
			// buat filter brdasarkan idrestoran
			// let xhr = createCORSRequest(method, proxyUrl + BASE_URI + dataType + '?idrest=' + idRestaurant + '&limit=' + limit);
			// xhr.onload = function () {
			// 	// do something with result here
			// 	let result = JSON.parse(xhr.response)
			// };

			// // buat filter brdasarkan tahun, bulan
			// let xhr2 = createCORSRequest(method, proxyUrl + BASE_URI + dataType + '/' + tahun + '/' + bulan);
			// xhr.onload = function () {
			// 	// do something with result here
			// 	let result = JSON.parse(xhr2.response)
			// };

			// xhr.onerror = function () {
			// 	// error callback here
			// 	alert("Error");
			// 	console.log(xhr.response);
			// };

			// xhr.setRequestHeader("Content-Type", "application/json");
			// xhr.send(jsonString);
		}
	</script>
</body>
</html>